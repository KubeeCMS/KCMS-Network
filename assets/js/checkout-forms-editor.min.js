!function(e){e(document).ready((function(){const t={components:{vuedraggable:vuedraggable},template:"#wu-table",props:["list","headers","step_name"],name:"wu-draggable-table",data:()=>({delete_field_id:""}),methods:{remove_field(e){wu_checkout_forms_editor_app.remove_field(this.step_name,e),this.delete_field_id=""}}};wu_checkout_forms_editor_app=new Vue({el:"#wu-checkout-editor-app",name:"CheckoutEditor",data:()=>Object.assign({},{dragging:!1,search:"",delete_step_id:"",preview_error:!1,preview:!1,loading_preview:!1,preview_content:""},wu_checkout_form),components:{vuedraggable:vuedraggable,"wu-draggable-table":t},computed:{field_count(){return _.reduce(this.steps,(function(e,t){return e+t.fields.length}),0)}},mounted(){this.update_session()},methods:{get_preview(t=null){if(null===t&&(this.preview=!this.preview),this.preview){this.loading_preview=!0;const s=this;e.ajax({method:"post",url:ajaxurl,data:{action:"wu_generate_checkout_form_preview",settings:s.steps,type:t},success(e){s.preview_error=!1,s.loading_preview=!1,e.success?s.preview_content=e.data.content:s.preview_error=!0}})}else console.log("no preview")},add_step(e){const t=this.find_step(e.id);if(void 0!==t){const s=_.indexOf(this.steps,t);(e=Object.assign({},t,e)).fields=t.fields,Vue.set(this.steps,s,e)}else this.steps.push(e);this.update_session()},add_field(e){const t=_.findWhere(this.steps,{id:e.step}),s=this.find_field(e.step,e.id);if(void 0!==s){const i=_.indexOf(t.fields,s);Vue.set(t.fields,i,e)}else t.fields.push(e);this.update_session()},find_step(e){return _.findWhere(this.steps,{id:e})},find_field(e,t){const s=_.findWhere(this.steps,{id:e});return _.findWhere(s.fields,{id:t})},remove_step(e){this.steps=_.reject(this.steps,(function(t){return t.id===e})),this.delete_step_id=""},remove_field(e,t){const s=_.findWhere(this.steps,{id:e});s.fields=_.reject(s.fields,(function(e){return e.id===t}))},update_session(){wu_initialize_tooltip();e.ajax({method:"post",url:ajaxurl,data:{action:"wu_save_editor_session",settings:this.steps,form_id:this.form_id},success(){}})}}})}))}(jQuery);